const strings=[" / ","substring","relative","left","starSize","px)","position","Ошибка Firebase. Добавьте атрибут firebaseURL=\"https://YOUR-FIREBASE.firebaseio.com\" к вашему скрипту рейтинга.","title","getBoundingClientRect","https://www.gstatic.com/firebasejs/8.1.1/firebase-app.js","https://","function","none","textAlign","Вы уже проголосовали, ваш рейтинг: $userRating$.","contains","appendChild","bottomText","0 0 0 -","borderTop","Ошибка Firebase","'Comic Sans MS', cursive, sans-serif","black","1nhfBNZ","'Palatino Linotype', 'Book Antiqua', Palatino, serif","body","Спасибо за ваш голос","script[src=\"https://www.gstatic.com/firebasejs/8.1.1/firebase-database.js\"]","textContent","100%","script[src=\"https://cdn.jsdelivr.net/gh/votix/votix/starrating8.js\"]","transition","oncontextmenu","Verdana, Geneva, sans-serif","Arial, Helvetica, sans-serif","47143XogIoc","zIndex","blockingText","'Lucida Sans Unicode', 'Lucida Grande', sans-serif",".kozyr-SRS-average","opacity","transparent","split","initializeApp","inline-block","forEach","full","https://1.bp.blogspot.com/-pOr9XGwtSJc/Wsjf8ULOIqI/AAAAAAAAAKE/KBh-LUDIn0YzASKf-t7mQo8UNpdHhr2SgCLcBGAs/s1600/pusta.png","display","width","getElementsByTagName","Ошибка Firebase. Введите URL-адрес вашего Firebase в атрибут \"firebaseURL\" в вашем скрипте рейтинга.","30639YMMkMx","database","0 0 0 0","querySelectorAll","173339trQLKh","kozyr-SRS-loader","dawaj 1s linear infinite","white","Ошибка Firebase. Неверный URL Firebase","firebaseio.com","lineHeight","firebaseURL","val","querySelector","'Times New Roman', Times, serif","6px solid #3498db","\"Lucida Sans Unicode\", \"Lucida Grande\", sans-serif","remove","scrollX","length","class","<span class=\"kozyr-SRS-average\">0</span>","25px","insertBefore","1.2","fullStarImg","'Arial Black', Gadget, sans-serif","createElement","calc(100% - ","'Trebuchet MS', Helvetica, sans-serif","hover","undefined","round","Trebuchet","src","22055DWlruy","\"Trebuchet MS\", Helvetica, sans-serif","Palatino","'Lucida Console', Monaco, monospace","offsetWidth","textColor","'Courier New', Courier, monospace","emptyStarImg","161966UeYhRY","https://www.gstatic.com/firebasejs/8.1.1/firebase-database.js","empty","div","script","value","onclick","hidden","ratingName","Lucida Console","1px solid #e0e0e0","align","preventDefault","bsrgl_","object","set","head","onmouseenter","host","https://3.bp.blogspot.com/-QSNdWP4Ijx4/Wsjf7QOUZ4I/AAAAAAAAAJ8/F2nReVG5WfA1rLV3dGcAFMsPOnIQck4YwCLcBGAs/s1600/pelna.png","Arial Black","Comic Sans","200px","fontSize","Impact","img","animation","1mZwkhr","9999999","\"Lucida Console\", Monaco, monospace","163289RoWWHX","boxSizing","wartosc","padding","removeChild","floor","SRSstar","borderRadius","default","thankYouText","fontFamily","other","cursor","Inherit","6px solid #f3f3f3","Times New Roman","getAttribute","parentNode","height","Среднее: <b>$average$</b> / $max$ (<b>$votes$</b> голосов)","setAttribute","ref","offsetHeight","onmouseleave","topText","textSize","Рейтинг:","maxWidth","innerHTML","numberOfStars","indexOf","border","7px","Tahoma","inherit","lastIndexOf","status","top","50%",".kozyr-SRS-votes","background","Verdana","pointer","scrollY","style","\"Palatino Linotype\", \"Book Antiqua\", Palatino, serif","Tahoma, Geneva, sans-serif","absolute","auto","right","replace","color","overflow","@keyframes dawaj {0% {transform: rotate(0deg);} 100% {transform:rotate(360deg);}} .kozyr-SRS-loader ~ div{visibility:hidden;}","www.","Impact, Charcoal, sans-serif","___","\"Arial Black\", Gadget, sans-serif","margin","57794AVuJQd","2CrxsFw","center"];function getString(index){return strings[index-423]}let starRatingGeneratorCount=typeof StarRatingGenerator===getString(297)?0:StarRatingGenerator+1;(function(generatorIndex){function loadScripts(){if(generatorIndex===0&&!document.querySelector('script[src="https://www.gstatic.com/firebasejs/8.1.1/firebase-app.js"]')){const script=document.createElement('script');script.src="https://www.gstatic.com/firebasejs/8.1.1/firebase-app.js";document.head.appendChild(script);script.onload=()=>{const dbScript=document.createElement('script');dbScript.src="https://www.gstatic.com/firebasejs/8.1.1/firebase-database.js";document.head.appendChild(dbScript)};const style=document.createElement('style');style.textContent=`@keyframes dawaj{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}.kozyr-SRS-loader~div{visibility:hidden}`;document.head.appendChild(style)}}function updateStars(element,rating,starSize){const stars=element.getElementsByTagName('SRSstar');for(let i=0;i<stars.length;i++){if(i<=rating){if(i<Math.floor(rating)){stars[i].querySelector('.full').style.width='100%';stars[i].querySelector('.empty').style.width='0%'}else{const partialStarValue=rating-Math.floor(rating);const width=Math.round(partialStarValue*starSize);stars[i].querySelector('.full').style.width=width+'px';stars[i].querySelector('.empty').style.width=starSize-width+'px';stars[i].querySelector('.empty').querySelector('img').style.marginLeft=`${width}px`}}else{stars[i].querySelector('.full').style.width='0%';stars[i].querySelector('.empty').style.width='100%';stars[i].querySelector('.empty').style.marginLeft='0'}}}function showThankYouMessage(message,ratingElement,userRating){const thankYouDiv=document.createElement('div');thankYouDiv.innerHTML=message.replace(/\$userRating\$/g,userRating);thankYouDiv.style.position='absolute';thankYouDiv.style.background='white';thankYouDiv.style.color='black';thankYouDiv.style.padding='10px 15px';thankYouDiv.style.border='1px solid #3498db';thankYouDiv.style.borderRadius='3px';thankYouDiv.style.zIndex='9999999';thankYouDiv.style.opacity='0';thankYouDiv.style.transition='opacity 1s';thankYouDiv.style.width='200px';thankYouDiv.style.boxSizing='border-box';thankYouDiv.style.textAlign='center';document.body.appendChild(thankYouDiv);const elementRect=ratingElement.getBoundingClientRect();setTimeout(()=>{thankYouDiv.style.opacity='1';const leftPos=ratingElement.style.textAlign==='right'?window.scrollX+elementRect.right+ratingElement.offsetWidth-200:ratingElement.style.textAlign==='center'?window.scrollX+elementRect.left+ratingElement.offsetWidth/2-100:window.scrollX+elementRect.left;thankYouDiv.style.left=leftPos+'px';thankYouDiv.style.top=(elementRect.top>thankYouDiv.offsetHeight?window.scrollY+elementRect.top-thankYouDiv.offsetHeight:window.scrollY+elementRect.top+thankYouDiv.offsetHeight)+'px'},10);setTimeout(()=>{thankYouDiv.style.opacity='0';setTimeout(()=>{document.body.removeChild(thankYouDiv)},500)},3000)}function initializeRating(index){const ratingElement=document.querySelectorAll('.kozyr-SRS')[index];let currentUrl=location.href.replace('www.','').replace(/\./g,'_').replace(/\//g,'__');if(currentUrl==='')currentUrl='default';let ratingName=ratingElement.getAttribute('ratingName');if(!ratingName||ratingName==='default'){let href=location.href.split('?')[0].split('#')[0].replace(location.protocol+'//','');if(href.slice(-1)==='/'||href.slice(-1)==='.'){href=href.substring(0,href.length-1)}href=href.replace(/\./g,'_').replace(/\//g,'__').replace(/\,/g,'_').replace(/\s/g,'');ratingName=href}ratingName=ratingName.replace(/\s/g,'_').replace(/\#/g,'-').replace(/\./g,'-').replace(/\@/g,'-').replace(/\!/g,'-').replace(/\$/g,'-').replace(/\%/g,'-').replace(/\&/g,'-').replace(/\(/g,'-').replace(/\)/g,'-');const emptyStarImg=ratingElement.getAttribute('emptyStarImg')||getString(263);const fullStarImg=ratingElement.getAttribute('fullStarImg')||getString(272);const hoverStarImg=ratingElement.getAttribute('hoverStarImg')||fullStarImg;const starSize=Number(ratingElement.getAttribute('starSize'))||25;const firebaseURL=ratingElement.getAttribute('firebaseURL')||'https://YOUR-FIREBASE.firebaseio.com';const align=ratingElement.getAttribute('align')||'left';const textSize=Number(ratingElement.getAttribute('textSize'))||15;const textColor=ratingElement.getAttribute('textColor')||'black';let fontFamily=ratingElement.getAttribute('fontFamily')||'Arial, Helvetica, sans-serif';switch(fontFamily){case'Georgia':case'Georgia, serif':fontFamily='Georgia, serif';break;case getString(298):case getString(313):fontFamily=getString(299);break;case getString(304):case getString(278):fontFamily='"Times New Roman", Times, serif';break;case'Arial':case getString(286):fontFamily=getString(286);break;case getString(300):case getString(296):fontFamily=getString(312);break;case getString(301):case getString(307):fontFamily='"Comic Sans MS", cursive, sans-serif';break;case getString(302):case'Impact, Charcoal, sans-serif':fontFamily=getString(311);break;case'Lucida Sans':case getString(288):fontFamily=getString(279);break;case getString(308):case getString(310):fontFamily=getString(310);break;case getString(295):case getString(292):fontFamily=getString(291);break;case getString(309):case getString(315):fontFamily=getString(315);break;case'Courier New':case getString(290):fontFamily='"Courier New", Courier, monospace';break;case getString(293):case getString(294):fontFamily=getString(289);break;default:fontFamily=getString(287)}const readonly=ratingElement.getAttribute('readonly')==='readonly';const topText=ratingElement.getAttribute('topText')||getString(303);const bottomText=ratingElement.getAttribute('bottomText')||getString(285);const numberOfStars=Number(ratingElement.getAttribute('numberOfStars'))||5;const thankYouText=ratingElement.getAttribute('thankYouText')||getString(314);const container=document.createElement('div');container.setAttribute('ratingName',ratingName);ratingElement.parentNode.insertBefore(container,ratingElement);container.style.textAlign=align;container.style.display='inline-block';container.oncontextmenu=(event)=>event.preventDefault();const loader=document.createElement('div');loader.setAttribute('class','kozyr-SRS-loader');loader.style.width='25px';loader.style.height='25px';loader.style.border='3px solid #3498db';loader.style.borderRadius='50%';loader.style.background='#3498db';loader.style.animation='dawaj 1s linear infinite';if(align==='center')loader.style.marginLeft='auto';else if(align==='right')loader.style.marginLeft=`calc(${starSize*numberOfStars}px+5px)`;container.appendChild(loader);const topTextElement=document.createElement('div');const bottomTextElement=document.createElement('div');bottomTextElement.innerHTML=bottomText.replace(/\$average\$/g,'<span class="kozyr-SRS-average">0</span>').replace(/\$votes\$/g,'<span class="kozyr-SRS-votes">0</span>').replace(/\$max\$/g,numberOfStars);topTextElement.innerHTML=topText;topTextElement.style.fontSize=textSize+'px';topTextElement.style.lineHeight='1.2';topTextElement.style.fontFamily=fontFamily;topTextElement.style.textAlign=align;topTextElement.style.color=textColor;container.appendChild(topTextElement);bottomTextElement.style.fontSize=textSize+'px';bottomTextElement.style.lineHeight='1em';bottomTextElement.style.fontFamily=fontFamily;bottomTextElement.style.textAlign=align;bottomTextElement.style.color=textColor;container.appendChild(bottomTextElement);let firebase_URL=ratingElement.getAttribute('firebaseURL')||'https://YOUR-FIREBASE.firebaseio.com';if(firebase_URL==='')firebase_URL='default';if(firebase_URL.indexOf('firebaseio.com')===-1)firebase_URL='https://YOUR-FIREBASE.firebaseio.com';if(firebase_URL.lastIndexOf('/')!==firebase_URL.length-1)firebase_URL+='/';const starsContainer=document.createElement('div');starsContainer.style.width=starSize*numberOfStars+'px';starsContainer.style.display='inline-block';container.appendChild(starsContainer);for(let i=1;i<=numberOfStars;i++){const star=document.createElement('SRSstar');star.style.display='inline-block';star.style.width=starSize+'px';star.style.cursor=!localStorage[ratingName]&&!readonly?'pointer':'default';star.setAttribute('data-star-index',i);if(!readonly){star.onclick=()=>{if(!localStorage[ratingName]){const stars=container.querySelectorAll('SRSstar');for(let j=0;j<stars.length;j++){j<i?(stars[j].querySelector('.full').style.width='100%',stars[j].querySelector('.empty').style.width='0%',stars[j].querySelector('.empty').style.marginLeft='0'):(stars[j].querySelector('.full').style.width='0%',stars[j].querySelector('.empty').style.width='100%',stars[j].querySelector('.empty').style.marginLeft='0')}if(topText!=='')topTextElement.innerHTML=i+' из '+numberOfStars;const averageRating=(0+i/numberOfStars)/1;const newData={OO:averageRating,O0:1};databaseRef.set(newData);localStorage[ratingName]=i;container.querySelectorAll('SRSstar').forEach(star=>star.style.cursor='default');showThankYouMessage(thankYouText,container,i)}else{showThankYouMessage(firebase_URL,container,localStorage[ratingName])}}}const fullStar=document.createElement('div');fullStar.style.display='inline-block';fullStar.style.overflow='hidden';fullStar.classList.add('full');const emptyStar=document.createElement('div');emptyStar.style.display='inline-block';emptyStar.style.overflow='hidden';emptyStar.classList.add('empty');const hoverStar=document.createElement('div');hoverStar.style.display='inline-block';hoverStar.style.overflow='hidden';hoverStar.classList.add('hover');const emptyStarImage=document.createElement('img');emptyStarImage.style.maxWidth='100%';emptyStarImage.style.display='block';emptyStarImage.style.width='0';emptyStarImage.style.padding='0';emptyStarImage.style.marginLeft='0';emptyStarImage.style.maxWidth='100%';emptyStarImage.src=emptyStarImg;const fullStarImageContainer=document.createElement('div');fullStarImageContainer.style.maxWidth='100%';fullStarImageContainer.style.display='block';fullStarImageContainer.style.width='0';fullStarImageContainer.style.padding='0';fullStarImageContainer.style.marginLeft='0';fullStarImageContainer.style.maxWidth='100%';fullStarImageContainer.src=fullStarImg;const hoverStarImageContainer=document.createElement('div');hoverStarImageContainer.style.maxWidth='100%';hoverStarImageContainer.style.display='block';hoverStarImageContainer.style.width='0';hoverStarImageContainer.style.padding='0';hoverStarImageContainer.style.marginLeft='0';hoverStarImageContainer.style.maxWidth='100%';hoverStarImageContainer.src=hoverStarImg;emptyStarImage.style.width=starSize+'px';fullStarImageContainer.style.width=starSize+'px';hoverStarImageContainer.style.width=starSize+'px';fullStar.appendChild(fullStarImageContainer);emptyStar.appendChild(emptyStarImage);hoverStar.appendChild(hoverStarImageContainer);star.appendChild(fullStar);star.appendChild(emptyStar);star.appendChild(hoverStar);starsContainer.appendChild(star)}container.appendChild(bottomTextElement);updateStars(container,0,starSize);if(firebase_URL.indexOf('https://')>-1){const firebaseConfig={databaseURL:firebase_URL};const app=firebase.initializeApp(firebaseConfig,ratingName+generatorIndex);const databaseRef=app.database().ref('StarRatingSystem/'+currentUrl+'/'+ratingName);databaseRef.on('value',snapshot=>{const data=snapshot.val()||{OO:0,O0:0};updateStars(container,data.OO*numberOfStars,starSize);if(container.contains(loader))loader.remove();starsContainer.onmouseover=()=>{updateStars(container,data.OO*numberOfStars,starSize);topTextElement.innerHTML=topText};container.querySelectorAll('.kozyr-SRS-average').forEach(averageElement=>averageElement.innerHTML=Math.round(data.OO*numberOfStars*100)/100);container.querySelectorAll('.kozyr-SRS-votes').forEach(votesElement=>votesElement.innerHTML=data.O0);if(!readonly){container.querySelectorAll('SRSstar').forEach((starElement,starIndex)=>{starElement.onclick=()=>{if(!localStorage[ratingName]){const averageRating=(data.OO*data.O0+(starIndex+1)/numberOfStars)/(data.O0+1);const newData={OO:averageRating,O0:data.O0+1};databaseRef.set(newData);localStorage[ratingName]=starIndex+1;container.querySelectorAll('SRSstar').forEach(star=>star.style.cursor='default');showThankYouMessage(thankYouText,container,starIndex+1);topTextElement.innerHTML=topText}else{showThankYouMessage(firebase_URL,container,localStorage[ratingName])}}})}})}else{container.innerHTML=firebase_URL}}function initialize(index){if(typeof firebase===getString(306)&&typeof firebase.database===getString(305)&&typeof firebase.initializeApp===getString(16)){initializeRating(index)}else{setTimeout(()=>initialize(index),50)}}loadScripts();initialize(generatorIndex)})(starRatingGeneratorCount);
