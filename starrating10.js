const srsStrings=[' / ','substring','relative','left','starSize','px)','position','Firebase error. Add attribute firebaseURL="https://YOUR-FIREBASE.firebaseio.com" to your rating script.','title','getBoundingClientRect','https://www.gstatic.com/firebasejs/8.1.1/firebase-app.js','https://','function','none','textAlign','You have already cast your vote, your rating is $userRating$.','contains','appendChild','bottomText','0 0 0 -','borderTop','Firebase error','\'Comic Sans MS\', cursive, sans-serif','black','1nhfBNZ','\'Palatino Linotype\', \'Book Antiqua\', Palatino, serif','body','Thanks for voting','script[src="https://www.gstatic.com/firebasejs/8.1.1/firebase-database.js"]','textContent','100%','script[src="https://cdn.jsdelivr.net/gh/votix/votix/starrating10.js"]','transition','oncontextmenu','Verdana, Geneva, sans-serif','Arial, Helvetica, sans-serif','47143XogIoc','zIndex','blockingText','\'Lucida Sans Unicode\', \'Lucida Grande\', sans-serif','.kozyr-SRS-average','opacity','transparent','split','initializeApp','inline-block','forEach','full','https://1.bp.blogspot.com/-pOr9XGwtSJc/Wsjf8ULOIqI/AAAAAAAAAKE/KBh-LUDIn0YzASKf-t7mQo8UNpdHhr2SgCLcBGAs/s1600/pusta.png','display','width','getElementsByTagName','Firebase error. Enter the URL adress of your Firebase to "firebaseURL" attribute in your rating script.','30639YMMkMx','database','0 0 0 0','querySelectorAll','173339trQLKh','kozyr-SRS-loader','dawaj 1s linear infinite','white','Firebase error. Invalid Fierabse URL','firebaseio.com','lineHeight','firebaseURL','val','querySelector','\'Times New Roman\', Times, serif','6px solid #3498db','"Lucida Sans Unicode", "Lucida Grande", sans-serif','remove','scrollX','length','class','<span class="kozyr-SRS-average">0</span>','25px','insertBefore','1.2','fullStarImg','\'Arial Black\', Gadget, sans-serif','createElement','calc(100% - ','\'Trebuchet MS\', Helvetica, sans-serif','hover','undefined','round','Trebuchet','src','22055DWlruy','"Trebuchet MS", Helvetica, sans-serif','Palatino','\'Lucida Console\', Monaco, monospace','offsetWidth','textColor','\'Courier New\', Courier, monospace','emptyStarImg','161966UeYhRY','https://www.gstatic.com/firebasejs/8.1.1/firebase-database.js','empty','div','script','value','onclick','hidden','ratingName','Lucida Console','1px solid #e0e0e0','align','preventDefault','bsrgl_','object','set','head','onmouseenter','host','https://3.bp.blogspot.com/-QSNdWP4Ijx4/Wsjf7QOUZ4I/AAAAAAAAAJ8/F2nReVG5WfA1rLV3dGcAFMsPOnIQck4YwCLcBGAs/s1600/pelna.png','Arial Black','Comic Sans','200px','fontSize','Impact','img','animation','1mZwkhr','9999999','"Lucida Console", Monaco, monospace','163289RoWWHX','boxSizing','wartosc','padding','removeChild','floor','SRSstar','borderRadius','default','thankYouText','fontFamily','other','cursor','Inherit','6px solid #f3f3f3','Times New Roman','getAttribute','parentNode','height','Average: <b>$average$</b> / $max$ (<b>$votes$</b> votes)','setAttribute','ref','offsetHeight','onmouseleave','topText','textSize','Rating:','maxWidth','innerHTML','numberOfStars','indexOf','border','7px','Tahoma','inherit','lastIndexOf','status','top','50%','.kozyr-SRS-votes','background','Verdana','pointer','scrollY','style','"Palatino Linotype", "Book Antiqua", Palatino, serif','Tahoma, Geneva, sans-serif','absolute','auto','right','replace','color','overflow','@keyframes dawaj {0% {transform: rotate(0deg);} 100% {transform:rotate(360deg);}} .kozyr-SRS-loader ~ div{visibility:hidden;}','www.','Impact, Charcoal, sans-serif','___','"Arial Black", Gadget, sans-serif','margin','57794AVuJQd','2CrxsFw','center'];const srsGetStr=(index)=>srsStrings[index];let StarRatingGenerator=typeof StarRatingGenerator==='undefined'?0:StarRatingGenerator+1;(function(generatorCount){const addFirebaseScript=()=>{const script=document.createElement('script');script.src='https://www.gstatic.com/firebasejs/8.1.1/firebase-app.js';document.body.appendChild(script);script.onload=()=>{const script2=document.createElement('script');script2.src='https://www.gstatic.com/firebasejs/8.1.1/firebase-database.js';document.head.appendChild(script2)}};const addStyles=()=>{const style=document.createElement('style');style.textContent=`@keyframes dawaj{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}.kozyr-SRS-loader~div{visibility:hidden}`;document.head.appendChild(style)};if(generatorCount===0&&!document.querySelector('script[src="https://cdn.jsdelivr.net/gh/votix/votix/starrating.js"]')){addFirebaseScript();addStyles()}function updateStars(_ratingContainer,filledStars,starSize){const stars=_ratingContainer.getElementsByTagName('SRSstar');for(let i=0;i<stars.length;i++){if(i<=filledStars){if(i<Math.floor(filledStars)){stars[i].querySelector('.full').style.width='100%';stars[i].querySelector('.empty').style.width='0%'}else{const remainingStars=filledStars-Math.floor(filledStars);const width=Math.round(remainingStars*starSize);stars[i].querySelector('.full').style.width=width+'px';stars[i].querySelector('.empty').style.width=starSize-width+'px';stars[i].querySelector('.empty').querySelector('img').style.margin=`0 0 0 ${width}px`}}else{stars[i].querySelector('.full').style.width='0%';stars[i].querySelector('.empty').style.width='100%';stars[i].querySelector('.empty').querySelector('img').style.margin='0 0 0 0'}stars[i].querySelector('.kozyr-SRS-average').style.width='0%'}}function showMessage(message,ratingContainer,userRating){const messageElement=document.createElement('div');messageElement.innerHTML=message.replace(/\$userRating\$/g,userRating);messageElement.style.textAlign='center';messageElement.style.background='transparent';messageElement.style.color='black';messageElement.style.border='1px solid #e0e0e0';messageElement.style.padding='3px 7px';messageElement.style.lineHeight='1.2';messageElement.style.fontSize='25px';messageElement.style.boxSizing='border-box';messageElement.style.fontFamily='"Lucida Console", Monaco, monospace';messageElement.style.opacity='0';messageElement.style.transition='opacity 1s';document.body.appendChild(messageElement);const rect=ratingContainer.getBoundingClientRect();setTimeout(()=>{messageElement.style.opacity='1';if(ratingContainer.style.textAlign==='right'){messageElement.style.left=window.scrollX+rect.left+ratingContainer.offsetWidth-100+'px'}else if(ratingContainer.style.textAlign==='center'){messageElement.style.left=window.scrollX+rect.left+ratingContainer.offsetWidth/2-100+'px'}else{messageElement.style.left=window.scrollX+rect.left+'px'}messageElement.style.top=(rect.top>messageElement.offsetHeight?window.scrollY+rect.top-messageElement.offsetHeight:window.scrollY+rect.top+messageElement.offsetHeight)+'px'},10);setTimeout(()=>{messageElement.style.opacity='0';setTimeout(()=>{document.body.removeChild(messageElement)},500)},3000)}function initRating(_ratingElement){const ratingName=_ratingElement.id.replace(/[^a-zA-Z0-9_]/g,'_');const emptyStarImg=_ratingElement.getAttribute('emptyStarImg')||'https://3.bp.blogspot.com/-QSNdWP4Ijx4/Wsjf7QOUZ4I/AAAAAAAAAJ8/F2nReVG5WfA1rLV3dGcAFMsPOnIQck4YwCLcBGAs/s1600/pelna.png';const fullStarImg=_ratingElement.getAttribute('fullStarImg')||'https://1.bp.blogspot.com/-pOr9XGwtSJc/Wsjf8ULOIqI/AAAAAAAAAKE/KBh-LUDIn0YzASKf-t7mQo8UNpdHhr2SgCLcBGAs/s1600/pusta.png';const hoverStarImg=_ratingElement.getAttribute('hoverStarImg')||fullStarImg;let numberOfStars=_ratingElement.getAttribute('numberOfStars')||5;numberOfStars=Number(numberOfStars);let align=_ratingElement.getAttribute('align')||'left';let defaultRating=_ratingElement.getAttribute('defaultRating')||0;defaultRating=Number(defaultRating);let textColor=_ratingElement.getAttribute('textColor')||'black';let fontFamily=_ratingElement.getAttribute('fontFamily')||'Arial, Helvetica, sans-serif';let readonly=_ratingElement.getAttribute('readonly')==='readonly'?true:false;let bottomText=_ratingElement.getAttribute('bottomText')||'Average: <b>$average$</b> / $max$ (<b>$votes$</b> votes)';let thankYouText=_ratingElement.getAttribute('thankYouText')||'Thanks for voting';let starSize=_ratingElement.getAttribute('starSize')||25;starSize=Number(starSize);const ratingContainer=document.createElement('div');ratingContainer.setAttribute('id',ratingName);_ratingElement.parentNode.insertBefore(ratingContainer,_ratingElement);ratingContainer.style.textAlign=align;ratingContainer.style.display='inline-block';const averageContainer=document.createElement('div');averageContainer.innerHTML=bottomText;averageContainer.style.fontSize=`${defaultRating}px`;averageContainer.style.lineHeight='1.2';averageContainer.style.fontFamily=fontFamily;averageContainer.style.textAlign=align;averageContainer.style.color=textColor;ratingContainer.appendChild(averageContainer);for(let i=1;i<=numberOfStars;i++){const star=document.createElement('SRSstar');star.style.display='inline-block';star.style.width=starSize+'px';star.style.overflow='hidden';star.style.cursor='pointer';const full=document.createElement('div');full.className='full';full.style.display='inline-block';full.style.width='0%';full.style.background=`url(${fullStarImg})`;full.style.backgroundSize='100%';full.style.maxWidth='200px';const empty=document.createElement('div');empty.className='empty';empty.style.display='inline-block';empty.style.width='100%';empty.style.background=`url(${emptyStarImg})`;empty.style.backgroundSize='100%';empty.style.maxWidth='200px';const img=document.createElement('img');img.src=emptyStarImg;img.style.width='100%';img.style.margin='0 0 0 0';empty.appendChild(img);star.appendChild(full);star.appendChild(empty);ratingContainer.appendChild(star);if(!readonly){star.onclick=function(){if(!localStorage[`rating_${ratingName}`]){let starsToUpdate=ratingContainer.querySelectorAll('SRSstar');for(let j=0;j<starsToUpdate.length;j++){j<i?(starsToUpdate[j].querySelector('.full').style.width='100%',starsToUpdate[j].querySelector('.empty').style.width='0%',starsToUpdate[j].querySelector('.kozyr-SRS-average').style.width='100%'):(starsToUpdate[j].querySelector('.full').style.width='0%',starsToUpdate[j].querySelector('.empty').style.width='100%',starsToUpdate[j].querySelector('.kozyr-SRS-average').style.width='0%')}localStorage[`rating_${ratingName}`]=i;showMessage(thankYouText,ratingContainer,i)}}}}updateStars(ratingContainer,defaultRating,starSize);const firebaseURL=_ratingElement.getAttribute('firebaseURL')||'';if(firebaseURL.indexOf('firebaseio.com')>-1){const databaseRef=firebase.database().ref('StarRatingSystem/'+location.host.replace(/\./g,'_').replace(/\//g,'__')+'/'+ratingName);databaseRef.on('value',snapshot=>{const data=snapshot.val();const averageRating=data?data.OO*numberOfStars:0;updateStars(ratingContainer,averageRating,starSize);averageContainer.innerHTML=bottomText.replace(/\$average\$/g,(data&&data.OO?data.OO.toFixed(1):0)).replace(/\$votes\$/g,'<span class="kozyr-SRS-votes">'+(data?data.O0:0)+'</span>').replace(/\$max\$/g,numberOfStars);ratingContainer.querySelectorAll('SRSstar').forEach(star=>star.onclick=function(){if(!localStorage[`rating_${ratingName}`]){let newRating=(averageRating*data.O0+(i+1)/numberOfStars)/(data.O0+1);const newData={OO:newRating,O0:data.O0+1};databaseRef.set(newData);localStorage[`rating_${ratingName}`]=i;showMessage(thankYouText,ratingContainer,i);ratingContainer.querySelectorAll('SRSstar').forEach(star=>star.style.cursor='default')}else{showMessage(srsGetStr(13),ratingContainer,localStorage[`rating_${ratingName}`])}})})}else{ratingContainer.innerHTML=firebaseURL?srsGetStr(56):srsGetStr(27)}}if(typeof firebase==='undefined'||typeof firebase.initializeApp!=='function'||typeof firebase.database!=='function'){setTimeout(()=>{initRating(generatorCount)},100)}else{initRating(generatorCount)}})(StarRatingGenerator);
